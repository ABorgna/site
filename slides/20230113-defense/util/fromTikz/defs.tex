% Math notation

\newcommand{\bigo}{\ensuremath{\mathcal{O}}}
\newcommand{\Dn}[1]{\ensuremath{\mathcal{D}_{#1}}} % Set of n-qubit density matrices
\newcommand{\M}{\ensuremath{\mathcal{R}}}
\newcommand{\N}{\ensuremath{\mathbb{N}}}
\newcommand{\R}{\ensuremath{\mathbb{R}}}
\newcommand{\W}{\ensuremath{\mathbb{W}}}
\newcommand{\Ztwo}{\ensuremath{\mathbb{Z}_2}}
\newcommand{\Ftwo}{\ensuremath{\mathbb{F}_2}}
\newcommand{\one}{\ensuremath{\mathbbm{1}}}
\newcommand{\diag}{\ensuremath{\mathcal{D}}} % Diagram
\newcommand{\circuit}{\ensuremath{\mathcal{C}}} % Circuit
\ifdefined\C
  \renewcommand{\C}{\ensuremath{\mathbb{C}}}
\else
  \newcommand{\C}{\ensuremath{\mathbb{C}}}
\fi
\ifdefined\U
  \renewcommand{\U}{\mathtt{U}}
\else
  \newcommand{\U}{\mathtt{U}}
\fi
\DeclareMathOperator{\trace}{tr}

\newcommand{\ketbra}[2]{\ket{#1}\!\!\bra{#2}}
\renewcommand{\braket}[2]{\langle#1\!\mid\!#2\rangle}
\newcommand{\ketR}{\ket{\circlearrowright}}
\newcommand{\ketL}{\ket{\circlearrowleft}}
\newcommand{\imod}[2]{{#1}\ \text{mod}\ {#2}} % integer modulo, n mod k
\newcommand{\idiv}[2]{{#1}\ \text{div}\ {#2}} % integer div, n div k

\DeclareMathOperator{\rank}{rank}
\DeclarePairedDelimiter\abs{\lvert}{\rvert}

% Types and terms
\newcommand{\bang}[1]{!^{#1}}
\newcommand{\meas}{\mathtt{meas}}
\newcommand{\new}{\mathtt{new}}
\newcommand{\bit}{\mathtt{B}}
\newcommand{\qubit}{\mathtt{Q}}
\renewcommand{\unit}{\mathtt{Unit}}
\newcommand{\nat}{\mathtt{Nat}}
\renewcommand{\vec}[2]{\mathtt{Vec}\ {#2}\ {#1}}
\newcommand{\Qlet}[3]{\mathtt{let\ }{#1}={#2}\mathtt{\ in\ }{#3}}
\newcommand{\Qfold}{\mathtt{fold}}
\newcommand{\Qmap}{\mathtt{map}}
\newcommand{\Qaccumap}{\mathtt{accuMap}}
\newcommand{\Qsplit}{\mathtt{split}}
\newcommand{\Qappend}{\mathtt{append}}
\newcommand{\Qcompose}{\mathtt{compose}}
\newcommand{\Qfor}[3]{\mathtt{for\ }{#1}\mathtt{\ in\ }{#2}\mathtt{\ do\ }{#3}}
\newcommand{\ifz}[3]{\mathtt{ifz\ }{#1}\mathtt{\ then\ }{#2}\mathtt{\ else\ }{#3}}
\newcommand{\vnil}{\mathtt{VNil}}
\newcommand{\Qrange}{\mathtt{range\ }}
\newcommand{\lambdaD}{\ensuremath{\lambda_D}}
\newcommand{\Qdrop}{\mathtt{drop}}

\newcommand{\trans}[1]{\left\llbracket{#1}\right\rrbracket}
\newcommand{\eval}[1]{\left\lfloor{#1}\right\rfloor}
\newcommand{\dual}[1]{{#1}^\bot}
\newcommand{\types}[1]{types({#1})} % For the list of types in a context

% Categories
\newcommand{\interpret}[1]{\left\llbracket{#1}\right\rrbracket}
\newcommand{\interpretZX}[1]{\left\llbracket{#1}\right\rrbracket}
\newcommand{\CPMo}{\ensuremath{\overline{\mathbf{CPMs}}^\oplus}}
\newcommand{\CPMs}{\textbf{CPMs}~}
\newcommand{\CPM}{\textbf{CPM}~}
% Symbols

\usetikzlibrary{circuits.ee.IEC}
\usetikzlibrary{shapes.gates.logic.US,shapes.gates.logic.IEC}

\newcommand{\ground}{%
    \begin{tikzpicture}[circuit ee IEC,yscale=1.0,xscale=1.0]
    \draw[solid,arrows=-] (0,1ex) to (0,0) node[anchor=center,ground,rotate=-90,xshift=.66ex] {};
    \end{tikzpicture}
}

%\usetikzlibrary{cd}
%\newcommand{\bvdots}{%
%  \tikz[baseline, every node/.style={inner sep=0}]{%
%    \node at (0,0){.}; \node at (0,-3pt){.}; \node at (0,3pt){.};
%  }
%}
\newcommand{\sground}{\scalebox{0.5}{\!\ground}}

% ZX diagrams

\newcommand{\zxGND}{\ensuremath{\text{ZX}_{\ground}}}
\newcommand{\zxGNDtitle}{%
  \texorpdfstring{%
    ZX\ifxetex{\unicodefont‚èö} \else ground \fi
  }{ZX ground}
} % used for section titles where we cannot use tikz symbols
\newcommand{\szxGND}{\ensuremath{\text{SZX}_{\ground}}}
\newcommand{\zxB}{\ensuremath{\text{ZX}^!}}

\newcommand{\toZxGND}[1]{T({#1})}
\newcommand{\fromZxGND}[1]{T^{-1}(#1)}

\newcommand{\figToZxGND}[1]{T\bigl({#1}\bigr)}
\newcommand{\figFromZxGND}[1]{T^{-1}\bigl({#1}\bigr)}

\newcommand{\outputs}{\mathsf{O}}
\newcommand{\inputs}{\mathsf{I}}

% - Gates

\newcommand{\AND}{\ensuremath{\text{AND}}}
\newcommand{\OR}{\ensuremath{\text{OR}}}
\newcommand{\NOT}{\ensuremath{\text{NOT}}}
\newcommand{\XOR}{\ensuremath{\text{XOR}}}
\newcommand{\CNOT}{\ensuremath{\text{CNOT}}}
\renewcommand{\H}{\ensuremath{\text{H}}}
\newcommand{\Z}[1][]{\ensuremath{\text{Z}_{#1}}}
\newcommand{\Rx}[1][]{\ensuremath{\text{X}_{#1}}}
\newcommand{\CZ}{\ensuremath{\text{CZ}}}

% Matrix size annotations
\newcommand{\annoted}[3]{{\scriptstyle~#1}\left\lbrace\mathrlap{\phantom{#3}}\right.\overbrace{#3}^{#2}}

% gFlow
\newcommand{\odd}{\mathsf{Odd}}

% Extraction
\newcommand{\frontier}{\mathsf{F}}
\newcommand{\fQubit}{\mathsf{Q}}

% classicality labels
\newcommand{\labels}{\ensuremath{\mathcal{L}}}
\newcommand{\Q}{\textsf{Q}}
\newcommand{\X}{\textsf{X}}
\newcommand{\Y}{\textsf{Y}}
%\newcommand{\Z}{\textsf{Z}}
\newcommand{\tJoin}{\star}
\newcommand{\rot}[1][\alpha]{\text{rot}_{#1}}
\DeclareMathOperator{\hadamLbl}{\H}
%\newcommand{\interpretLbl}[1]{\left\llbracket{#1}\right\rrbracket}
\newcommand{\interpretLbl}[1]{#1}
\newcommand{\ClassHadamRule}{\ensuremath{(\bm{ch})}}
\newcommand{\ClassZRule}{\ensuremath{(\bm{cz})}}
\newcommand{\ClassXRule}{\ensuremath{(\bm{cx})}}